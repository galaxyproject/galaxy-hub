---
import { getCollection, render } from 'astro:content';
import ArticleLayout from '../../layouts/ArticleLayout.astro';

export async function getStaticPaths() {
  const articles = await getCollection('articles');

  // Filter to only news articles (those with slug starting with news/)
  const newsArticles = articles.filter(article => article.data.slug.startsWith('news/'));

  return newsArticles.map(article => {
    // Remove 'news/' prefix from slug for the URL
    const urlSlug = article.data.slug.replace(/^news\//, '');
    return {
      params: { slug: urlSlug },
      props: { article },
    };
  });
}

const { article } = Astro.props;
const { Content } = await render(article);

const { title, date, authors = [], tags = [], tease, image } = article.data;
---

<ArticleLayout
  title={title || 'News'}
  description={tease}
  date={date}
  authors={authors}
  tags={tags}
  image={image}
>
  <Content />
</ArticleLayout>
