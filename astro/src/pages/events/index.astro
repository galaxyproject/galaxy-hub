---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import PageHeader from '../../components/layout/PageHeader.astro';
import EventsList from '../../components/events/EventsList.vue';

// Get all events and prepare data for client component
const events = await getCollection('events');

// Transform to plain objects for Vue component
const eventData = events.map((e) => ({
  slug: e.data.slug,
  title: e.data.title || 'Untitled Event',
  date: e.data.date instanceof Date ? e.data.date.toISOString() : e.data.date,
  end: e.data.end instanceof Date ? e.data.end?.toISOString() : e.data.end,
  tease: e.data.tease,
  location: e.data.location,
  subsites: e.data.subsites,
}));
---

<BaseLayout title="Events" description="Galaxy Project events, workshops, and conferences">
  <div class="max-w-6xl mx-auto">
    <PageHeader title="Events" description="Workshops, conferences, and community gatherings" />

    <div class="bg-white px-6 sm:px-8 py-6 rounded-b-lg shadow-sm">
      <EventsList client:load events={eventData} />
    </div>
  </div>
</BaseLayout>
