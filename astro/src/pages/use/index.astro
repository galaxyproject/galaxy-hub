---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/BaseLayout.astro';

// Get all platform entries
const platforms = await getCollection('platforms');

// Group platforms by region or type if needed
const publicServers = platforms.filter(p => !p.data.url?.includes('localhost'));
---

<Layout title="Use Galaxy">
  <div class="container my-5">
    <h1>Use Galaxy</h1>
    
    <p class="lead">
      Galaxy is available through numerous public servers, each offering different tools and capabilities.
      Choose a server that best fits your research needs.
    </p>

    <div class="alert alert-info mb-4">
      <strong>New to Galaxy?</strong> 
      Start with <a href="https://usegalaxy.org">UseGalaxy.org</a>, 
      <a href="https://usegalaxy.eu">UseGalaxy.eu</a>, or 
      <a href="https://usegalaxy.org.au">UseGalaxy.org.au</a> - 
      the primary public Galaxy servers with extensive tool collections.
    </div>

    <h2 class="mt-5">Public Galaxy Servers</h2>
    
    <div class="row">
      {publicServers.map(platform => (
        <div class="col-md-6 col-lg-4 mb-4">
          <div class="card h-100">
            <div class="card-body">
              <h5 class="card-title">
                {platform.data.url ? (
                  <a href={platform.data.url} target="_blank" rel="noopener noreferrer">
                    {platform.data.title || 'Galaxy Server'}
                  </a>
                ) : (
                  platform.data.title || 'Galaxy Server'
                )}
              </h5>
              
              {platform.data.summary && (
                <p class="card-text">{platform.data.summary}</p>
              )}
              
              {platform.data.scope && (
                <p class="card-text">
                  <small class="text-muted">Focus: {platform.data.scope}</small>
                </p>
              )}
            </div>
            
            <div class="card-footer bg-transparent">
              <a href={`/${platform.data.slug}`} class="btn btn-sm btn-outline-primary">
                Learn More
              </a>
            </div>
          </div>
        </div>
      ))}
    </div>

    {platforms.length === 0 && (
      <div class="alert alert-warning">
        Platform information is being migrated. Check back soon!
      </div>
    )}

    <hr class="my-5" />

    <h2>Other Ways to Use Galaxy</h2>
    
    <div class="row">
      <div class="col-md-6">
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Galaxy on the Cloud</h5>
            <p class="card-text">
              Deploy your own Galaxy instance on cloud infrastructure using CloudMan or Kubernetes.
            </p>
            <a href="/cloud" class="btn btn-primary">Cloud Options</a>
          </div>
        </div>
      </div>
      
      <div class="col-md-6">
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Local Installation</h5>
            <p class="card-text">
              Install Galaxy on your own hardware for complete control and customization.
            </p>
            <a href="/admin/get-galaxy" class="btn btn-primary">Installation Guide</a>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Commercial Support</h5>
            <p class="card-text">
              Several companies offer commercial support, hosting, and consulting for Galaxy.
            </p>
            <a href="/support/commercial" class="btn btn-primary">Commercial Options</a>
          </div>
        </div>
      </div>
      
      <div class="col-md-6">
        <div class="card mb-4">
          <div class="card-body">
            <h5 class="card-title">Container Images</h5>
            <p class="card-text">
              Run Galaxy using Docker or Singularity containers for easy deployment.
            </p>
            <a href="/admin/config/containers" class="btn btn-primary">Container Guide</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</Layout>