---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// Get all news articles
const articles = await getCollection('articles');
const newsArticles = articles
  .filter(article => article.data.slug.startsWith('news/'))
  .filter(article => article.data.date)
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
---

<BaseLayout title="News">
  <div class="container my-5">
    <h1>Galaxy News</h1>
    <p class="lead">Stay up to date with the latest from the Galaxy community.</p>
    
    <div class="row">
      <div class="col-lg-8">
        <div class="news-list">
          {newsArticles.map((article) => (
            <article class="card mb-4">
              <div class="card-body">
                <h2 class="card-title h4">
                  <a href={`/${article.data.slug}`}>
                    {article.data.title}
                  </a>
                </h2>
                
                {article.data.tease && (
                  <p class="card-text">{article.data.tease}</p>
                )}
                
                <div class="article-meta text-muted small">
                  <span class="date">
                    {new Date(article.data.date).toLocaleDateString()}
                  </span>
                  {article.data.authors && (
                    <span class="authors ml-3">
                      By {Array.isArray(article.data.authors) 
                        ? article.data.authors.join(', ') 
                        : article.data.authors}
                    </span>
                  )}
                </div>
                
                {article.data.tags && article.data.tags.length > 0 && (
                  <div class="tags mt-2">
                    {article.data.tags.map((tag) => (
                      <span class="badge badge-secondary mr-1">{tag}</span>
                    ))}
                  </div>
                )}
              </div>
            </article>
          ))}
        </div>
        
        {newsArticles.length === 0 && (
          <div class="alert alert-info">
            No news articles found.
          </div>
        )}
      </div>
      
      <div class="col-lg-4">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">About Galaxy News</h5>
            <p class="card-text">
              This page lists news items from the Galaxy community including
              announcements, updates, and highlights from Galaxy users.
            </p>
            <hr />
            <h6>Subscribe</h6>
            <p class="small">
              Stay informed about Galaxy news by subscribing to our 
              <a href="/feed.xml">RSS feed</a> or following us on 
              <a href="https://twitter.com/galaxyproject">Twitter</a>.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</BaseLayout>

<style>
  .news-list .card {
    transition: box-shadow 0.3s;
  }
  
  .news-list .card:hover {
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }
  
  .card-title a {
    color: inherit;
    text-decoration: none;
  }
  
  .card-title a:hover {
    color: #007bff;
  }
  
  .article-meta {
    font-size: 0.875rem;
  }
</style>