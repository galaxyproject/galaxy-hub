---
/**
 * Bare EU News Page
 * Shows EU-filtered news articles in a table layout (8.3k visits)
 * Embedded in Galaxy EU interface
 */
import { getCollection } from 'astro:content';
import BareArticleLayout from '../../../layouts/BareArticleLayout.astro';
import NewsTable from '../../../components/bare/NewsTable.astro';
import Insert from '../../../components/Insert.astro';

const allArticles = await getCollection('articles');
const newsArticles = allArticles
  .filter((article) => {
    const path = article.data.slug || article.id;
    const subsites = article.data.subsites || [];
    const isNews = path.startsWith('news/') || path.startsWith('news--');
    const isEU =
      subsites.includes('eu') ||
      subsites.includes('all') ||
      subsites.includes('all-eu') ||
      subsites.includes('global') ||
      subsites.length === 0;
    return isNews && isEU && !article.data.draft;
  })
  .sort((a, b) => {
    const dateA = a.data.date ? new Date(a.data.date) : new Date(0);
    const dateB = b.data.date ? new Date(b.data.date) : new Date(0);
    return dateB.getTime() - dateA.getTime();
  })
  .slice(0, 50);
---

<BareArticleLayout title="Galaxy Europe News">
  <Insert name="/eu/news/main" />

  {newsArticles.length > 0 ? <NewsTable articles={newsArticles} /> : <p>No news articles found.</p>}
</BareArticleLayout>
