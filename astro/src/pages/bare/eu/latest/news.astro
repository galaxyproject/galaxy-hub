---
/**
 * Bare EU Latest News Page
 * Shows most recent EU news articles in a compact format (36.2k visits!)
 * Embedded in Galaxy EU interface - high visibility feed
 */
import { getCollection } from 'astro:content';

const allArticles = await getCollection('articles');
const newsArticles = allArticles
  .filter((article) => {
    const path = article.data.slug || article.id;
    const subsites = article.data.subsites || [];
    const isNews = path.startsWith('news/') || path.startsWith('news--');
    const isEU =
      subsites.includes('eu') ||
      subsites.includes('all') ||
      subsites.includes('all-eu') ||
      subsites.includes('global') ||
      subsites.length === 0;
    return isNews && isEU && !article.data.draft;
  })
  .sort((a, b) => {
    const dateA = a.data.date ? new Date(a.data.date) : new Date(0);
    const dateB = b.data.date ? new Date(b.data.date) : new Date(0);
    return dateB.getTime() - dateA.getTime();
  })
  .slice(0, 5);
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Latest Galaxy Europe News</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        font-size: 14px;
        line-height: 1.5;
        color: #333;
        background: transparent;
        padding: 15px;
      }

      .home-card {
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 4px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .card-header {
        background: #f5f5f5;
        border-bottom: 1px solid #ddd;
        padding: 12px 15px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .card-header-icon {
        color: #25537b;
        font-size: 18px;
      }

      .card-header-title {
        font-size: 16px;
        font-weight: 600;
        color: #25537b;
        flex: 1;
        text-decoration: none;
      }

      .card-header-title:hover {
        text-decoration: underline;
      }

      .card-header-link {
        color: #25537b;
        text-decoration: none;
        font-size: 14px;
      }

      .card-header-link:hover {
        text-decoration: underline;
      }

      .card-body {
        padding: 0;
      }

      .news-list {
        list-style: none;
        margin: 0;
        padding: 0;
      }

      .news-item {
        padding: 12px 15px;
        border-bottom: 1px solid #eee;
      }

      .news-item:last-child {
        border-bottom: none;
      }

      .news-item a {
        color: #25537b;
        text-decoration: none;
        font-weight: 400;
      }

      .news-item a:hover {
        text-decoration: underline;
      }

      .news-tease {
        color: #666;
        font-size: 13px;
        margin-top: 4px;
        line-height: 1.4;
      }
    </style>
  </head>
  <body>
    <div class="home-card">
      <div class="card-header">
        <a
          href="https://galaxyproject.org/bare/eu/news/"
          target="_blank"
          style="color: inherit; text-decoration: none;"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 512 512"
            style="color: #25537b; font-size: 25px; line-height:28px; height:25px;"
            ><!--!Font Awesome Free v7.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.-->
            <path
              fill="currentColor"
              d="M461.2 18.9C472.7 24 480 35.4 480 48l0 416c0 12.6-7.3 24-18.8 29.1s-24.8 3.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63l0 95.7c0 17.7-14.3 32-32 32l-32 0c-17.7 0-32-14.3-32-32l0-96C57.3 384 0 326.7 0 256S57.3 128 128 128l84.5 0c61.8-.2 121.4-22.7 167.9-63.3l46.6-40.7c9.4-8.3 22.9-10.2 34.3-5.1zM224 320l0 .2c70.3 2.7 137.8 28.5 192 73.4l0-275.3c-54.2 44.9-121.7 70.7-192 73.4L224 320z"
            ></path></svg
          >
        </a>
        <a href="https://galaxyproject.org/bare/eu/news/" class="card-header-title" target="_blank">News</a>
        <a href="https://galaxyproject.org/bare/eu/news/" class="card-header-link more-link" target="_blank"
          >More news</a
        >
      </div>
      <div class="card-body">
        <ul class="news-list">
          {
            newsArticles.map((article) => {
              const slug = (article.data.slug || article.id)
                .replace(/\.mdx?$/, '')
                .replace(/--/g, '/')
                .replace(/^news\//, '');
              return (
                <li class="news-item">
                  <a href={`https://galaxyproject.org/news/${slug}/`} target="_blank">
                    {article.data.title}
                  </a>
                  {article.data.tease && <div class="news-tease">{article.data.tease}</div>}
                </li>
              );
            })
          }
        </ul>
      </div>
    </div>
    <script>
      import { notifyParent } from '../../../../utils/iframe';
      notifyParent();
    </script>
  </body>
</html>
